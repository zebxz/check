

i cudnt install terrafrm                       ............... ASSIGNMENT: 1:25:30

38:00 , watch what he did .........
remember when u intialize terfrm , u nid to be in the dir where your files are 

user data, boot straping, terfrm has built in functions ,THERE ARE 2Wya we can PASS DATA, PROVISIONERS, passing a key ,secret/ .gitgnoire, meta arguments, TYPES OF META 
ARGUMENTS , IMPLICIT/EXPLICIT Dependencies, converting list to set of string

########  am goin to intro u to anod IDE  i like using called itelligie     .............. 26:00
bt its nt any diff frm vscode




15:20
we use data sources to get info to return info for us frm an API, IF WE wnt 2 get info frm AWS, mayb frm a vpc, AN INSTANCE, a s3 bucket, this obj we wnt to get info abt,
first it has to exist,   so if we hv an ec2 instance tht exists we are able to get info abt the instance ,  the id , public addres, its dns 
so we can use a data source and pass in our filters and we are able to filter out all d amis that are der and we are ablle to return jst the value of what we nid
we use data source for automation bc as engr u dnt want to go to d console to manually copy an ami or any info/attribute,instaed u can automate d proces by runing a comand 
an data source wil go fast into aws , it wil get the attribute/info that u need n terrafrm gives u a way wherby u can aripolate that, u can pass d it directly to d resource 
ur creating

e.g 
if we were  creating an instance, bc we hv a data source dat we are using, we able to directly pass taht as our AMI, N what we are pasing is that attribute we wnt to get
. we knw that the AMI nids to b an id, so we ar using a data source as it reads data frm that particular AMI source, we wnt it to return an id n as it returns an id we are
directin paasing it to d resource so d data source gets the infpoo n we pass it as an input to our resource n this is how we use data source to provision our resource 



21:00
INTERVIEW QUESTION
1)what is user data????
under whosee/which persmission will the instance b boot straping???  ... it wil use root permission
we hv a root usre whenevr ur instalin a pasvclkage it wil us ea root credential
2) what is booth straping???
the root user wil create ur default user and add them to d sudoers grp,that is the process of booth straping

we are using it for boot strapping, if we hv any nfo we want to pass to our instance
e,g in creatin an instance when u are passing user dta, when the instance is boot straping, it wil be bot straping with some permission
whgen u are boot straping an instance like linx or ubuntu, der wiul be a default user who is created, that is an ubuntu user
but who creats the  ubnuntu user when the instance is creatin,???????????????
der is root ,
the root user wil create ur default user and add them to d sudoers grp,that is the process of booth straping  so that this ubuntu has
permission to do what root can do
so when ur boot strapin naad ur using user data , the user data wil use rot permison, terfrm also gives us that option
*************************  24:30 ...
whenever we creatin an instance , in google he type aws_intsance terrfrm 
we see d arguments in alphabetical order and we can see user data , so i see i can pass in user data as a script,i can pass in as commands 
dat terfrm wil use when its boot straping dat  instance , it is going to create the instance


am goin to intro u to anod IDE  i like using called itelligie , its open source    .............. 26:00
bc of hw it organises my dir n files n am abale to easily look at my files like this
bt its nt any diff frm vscode
U CAN STILL Use ur vs code if u hv it , IDE is jst an integrated development env, der are multiple u can wrk with
as u continuie working u can xperiment n find out the one u prefer
********* for d sake of dis am goin to continue wit inteligie n put away my vscode bty its nt diff

**********28:20
i hv a data source for an amazonn linux 
a rsource for an instance i wnt to create
am nt hardcoding the value of d AMI, i using a data source to get my AMI
i can use a variable and call it  "instance type" .............................29.30
then i refer to this variable i created
i have a user data (a bash script) to install httpd , make a dir 
so this user data becomes my script that will booth strap when the instance starts
**************    am passing the user data as a file  and the file is in the PWD and its called app1-install.sh"


WATCH ............32:08   .. whenevr u use data ull pass it as a file, this is a function
in terfrm, it has what is called functions
if u google terfrm funtions , terfrm has built in functions ,   ther are various function for diff purposse
you can use dem to manipulate data 
e.g file function 
file reads the contents of a  file at a given path and returns  them as a a string
so when u use a file function , u wil nid to give it a path
we hv an example below
> file ("${path.module}/hello.txt")    ...... path.module indicates the file is in the PWD and then the name of the file ur passing
so the file function will read ("${path.module}/hello.txt") and return the content of that particular file     .....................................34.20
i also looka t my providers .....

anoda tin i will like to introduce to you guys is that i can open my IDE from here,
and as u begin to work esp in d industry u wil see that many engr prefrer to hav a terminal,that runs their code 

38:00 , watch what he did .........
remember when u intialize terfrm , u nid to be in the dir where your files are 


54.13************************ THERE ARE 2Wya we can PASS DATA
in the example we just illustrated above, we see that it was part of conggiguration, trefrm did provisioning , it provionsioned our instance but not only did it provision it
it also configured  it
the process of configuration is when ur installing softwRE, 
SO TRFRM gives us a way that not only can we provison our infrsastruture bt we can also configure it 
so this is alos part of config mgt, we can use a script, we can use user data to configure it 
but as we go on ill show u anoda way wich w ecall PROVISIONERS

so trfrm can also give us a second method in which we can config our infarsture by using PROVIONERS ........................................55:11
    BUT AS U LOOK TRU documentation  , IT SAys use provisioners as a last resort
its nt the most recommemde way to do config bc of the nature of ehat provisioners do bc if a provioner fails , it will have to destroy the resource for it to be created again
thats why provisioners is a last resort

so if u want to do any config on ur instance esp as boot sratping then u cn pass user data


QUESTION
1)what do we do when we dnt knw the right attribute to pass???

ANS;
just depend on documnetation whener u are lost or smt isnt clear , like ur nt sure of what  attribute or argument ur suppose to pass
just cm to d dcoumentation n just look at arguments and attributes

2) we tried to create instance using a file but when we tried to create anoda instance , we realise that it destroys the first instance created, does that mean one file for 
one instance

ANS;
THats why we said st the first class that, you can creat as many type of instance as possible but what must be unique is your resource name 
the name must be unique to trfrm bc trfm keeps a atate file
when u try to create a 2nd instance wit the sam e resource name , whne trfrm check the statefile n your congiguration file, it doesnt see any diff so it will think u 
wnat to create the same instance again and so it will destroy the pevious one 
so lways make sure the name is unique

when we look at meta data shortly frm now, we will see we can create a resource even with the same name 
how we can cerate multiple resources even with the sam ename  , how terfrm handles that using meta arguments    ............... 1:10:50

1:10 .00 ************* he gave exmaple how to pass a subnet 

3) do we need to create the vpc first if we want to create our instance in the customized vpc?

ANS:
YES you wil need to need to hv a vpc that exists first but if ur nt using custom the it means ur using default and so u dnt need to passa any argument to ur resourec
trfrm wil place it in the defult vpc


1:26:41*****************   PASSING A KEY .............. a key need to associate with ur instance  ............... WATCH

first i need to lokk at my provider 
the provider is in us wwest2
i neeed to go to my aws console , sign in amd mk sure am in west2
i need to look at the key pairs i have in that region 
i look at my documentation, hw do i pass a key , i look at my arguments , scroll down to k
so always make sure you have that the key exists and the key is in ur env , for e.g in dis case, its west2

we will see how we can create our key using the ssh key gen command and u can create the private/public key on ur terminmal n dpass the key to terfrm n terfrm wil associate
that key wit ur instance bc u wil have both ur private key in ur env and it wil tk the public key and attach it to ur instance at ceration

                                        
1:354:00  .gitgnoire file for creating a secret
first i create the secret file and write the secret know only to me  e.g db_password = "landmark123"     terraform apply -var-file=secret.tfvars
but if am working with a team, ur working collaboratively, ur using .gitgnoire (inside  the .gitgnoire file, he refered to the secret file he wrote: secret.tfvars)
so am passing .gitnoir, if i push this code to you , u will not hv dis file the secret file, so u wont be able to see it
i creat my variable n mark it as sensitive = true so when trfrm create the statefile its nt going to output the value of d variable, it nt goin to be captured in d statefile 
as plain state , otherwiae anyone who has access to ur statefile are able to see ur secret
any thing u dnt wnat exposd, u mark it as senesitive n ter frm will nt expose it as an ouput or within ur statefile



############  #######################     1:44:30 
                         
                                  META ARGUMENTS   ............... REFer to note file in github
so far w ve been dealing with  Aruments are what we pass into our terrfm resource  when  we wnt to create a resourec or when we wnat to get data, uisng data source , w ecan 
use argument

META ARGUMENTS : these are arguments that alter the behaviour of a a resource , they dnt cahneg d resource they only change hw it behaves


INTERVIEW QUESTIONS  , WHta is meta arguments
meta arguments are what i pass into my terfrm resource to alter the behaviour  of hw the resource behaves

   ther are 5types
depends on
count
for_each
provider
lifecycle

your understanding of hw these wrk wil hekp u to easly wrk wit trefrm bc u can moduleize ur code otr create dependecies, u can reduce ur code to 
10lines of code bc u hv meta argument that can create resourecs jst based on the conditions that u pass


1) depends on:
trfrm has a feature of identifying resource dependency. this means that tfrm internally knws d sequence in wich d dependant resources needs to be craeted 
wheras the independent resources are created in parrallel.
ie if u have 2resources that are depndent on each other, terfrm internally has a way of identifying wich resource has to be created first b4 the other , 

depends_on meta-argument must be a list of refernces to other resources in the same calling resource.
 

   INTERVIEW QUESTIONS, 
What are implicit dependencies???

ANS:
THis is a situation wherby terfrm internally identifies d dependencies of resource n therfrore its able to identify which resource to create first, so it is abt dependencies
so if u dnt pass any depends on argument but tefrm still organizes which arguments needs to be created first then that becomes implicit depencies, its an inbuilt functionality
of tfrm that identifies which resource nids to be created first 


EXPLICIT DEPENDENCIES
this is whne u determine urself manaually the order resources are created 
this is done by apssing a depend_on meta argumentq


he showed an e.g,
in our caling resourec file we have a resource for an instance, and a rsorec for a vpc 
terfrm plan and we see the plan is to first create the instance and then the vpc 
and then terraform apply: we see vpc creating and instance creating 
lets create a dependency
i want the vpc to depend on the instance, so that means the vpc can only be created after the instance has beeen craeted
so in my vpc i can say that this vpc depends on = the aws instance 
we pass it as a list bc we can put multiple arguments in there
depends on = [aws_instance.myec2]
can run terfrm format so it formats the code 
thne trfrm apply 
and we see its first goin to create the instance first
we dnt see any vpc creating as it did earlier
so have altered the behaviour
so after my instance have been created then it can then create the vpc 
this explicit , am defining hw i want my resources to be created
butb if i wanted my vpc to be created first then ill say my instance depends on ....

2) count 
it can be specified in resources as well as modules 
in trfrm a resource blk actually configures only one infrastructure obj by defaault.
if we want mutiple resources wit same configurations, w ecan define d count meta-argument
this reduce the overhaeds of duplictaing the resource blk that number of times
ie with count meta-argument we can change tefrm hw the resourec wil behave 
e.g, so if i want to create 2instances, instaed of dupicating the resourec but i hv to change the name
these are too many lines of code to maintain  
so id rather introduce a meta argument and it will toveride the defaault
count = 3     ... that is it wil craete the resourec 3times 

***************but to be able to differentiate each of the created resource we pass a count.index , the index has to be whole numbers
the index ranges from 0 t0 -1
so if i want to create 3 instances 
count = 3
Name = "server-$(count.index)"
subsequently the instances wil be   ...................2:09:00
server-index1
server-index2
server-index3

the name that will be captUred in the statefile will have the index indicated
so we using the same code to create multiple instances 
the ami, user data, the instance type are all the same 

  ************************ LIMITATIONS OF COUNT ***************
bc count uses an index 
for e.g we created 4 instances and then i remove/ delete one instance from the list , count will try to reindex all the incidents instance and it wil delete all and then
recreate all again bc the index has to be frm 0 upwards.
also if go in the middle of the list and u remove an element frm a list then it means all the subsequent element needs to be resequenced
ie u removed index 2, so index 3, 4, 5 hv to be reconfigured to make the arrangment of the numbers accordingly

so bc of that trfrm also has anoda argument called: 

3)    FOR EACH   ............... THIS is more flexible        ...............2:17


e.g resource "aws_instance" "myec2" {
for each = var.instance_type
ami           = data.aws_ami.amzlinux2.id
instance type = so instaed of this: var.instance_type     ***********we cahngeit to : each.value 
user_data    = file("${path.module}/app1-install.sh")          ie for each of the list (t2.micro", "t2.medium", "t3.micro) we wnt the instance typ to b for each
tag = {                                                               so for each one the instance type wil be the value 
   "Name" = "EC2Demo-${count.index)"
 }
}


varaiable "instance_type" {
    type = list(string)
    default = ["t2.micro", "t2.medium", "t3.micro"]

****************************************bt this wont work bc for each works with either a map or a set of strings 
run tefrm plan and we get an error : invalid for_each argument 

****************** so bc of this we can use a tefrm function to convert our list into a set of strings bc we cant convert to  amap bc we dnt hv key value pairs in here.

     CONVERTING LIST INTO SET OF STRING
we have a function called to set 
its used to convert a list or a map into a set 
 e.g
for each = toset(var.instance_type)
ami           = data.aws_ami.amzlinux2.id
instance type = each.value            ************** but if its a map : each.key , you supply the key then it wil return the value
user_data    = file("${path.module}/app1-install.sh")        
tag = {                                                           
   "Name" = "EC2Demo-${count.index)"

terrform plan 
and its successfull

so this how we use meta data for hw a resource behave or hw terfrm handles a resource.

2:29:00   ********************* but if its a map : each.key , you supply the key then it wil return the value of the key supplied.

4) provider     






































